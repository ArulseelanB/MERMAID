<html>
  <head> </head>

  <body>
    <h2>Theme Variables</h2>

    <svg id="1">
      <g>
        <text id="a"></text>
      </g>
    </svg>

    <svg id="2">
      <rect id="b"></rect>
      <g>
        <text id="c"></text>
      </g>
    </svg>

    <div id="d"></div>

    <script type="text/javascript" src="https://d3js.org/d3.v7.js"></script>
    <!-- <script src="./mermaid.js"></script> -->
    <script>
      const markerId = (elem, name) => {
        var node = (elem) => {
          let elemNode;
          elem.select((node, data, i, group) => {
            elemNode = i[0];
          });

          return elemNode;
        };

        var svgNode = (node) => {
          const parent = node && node.parentElement;
          if (parent) {
            if (parent.tagName.toUpperCase() === 'SVG') {
              return parent;
            } else {
              return svgNode(parent);
            }
          }
          return null;
        };

        var svg = svgNode(node(elem));

        if (svg) {
          const svgId = svg.getAttribute('id').replace(/\D/, '');
          return name + '-' + svgId;
        }
        return name;
      };

      const a = d3.select('#a');
      const b = d3.select('#b');
      const c = d3.select('#c');
      const d = d3.select('#d');

      const x = d3.select('#invisibleG');

      console.log('a', markerId(a, 'A'));
      console.log('b', markerId(b, 'B'));
      console.log('c', markerId(c, 'C'));
      console.log('d', markerId(d, 'D'));
      console.log('x', x);
    </script>
  </body>
</html>
